{"ast":null,"code":"var _jsxFileName = \"D:\\\\projects\\\\spark\\\\spark_front\\\\src\\\\authentication\\\\users\\\\widgets\\\\ChatRoom.js\";\nimport { AppBar, Avatar, Card, CardActions, CardContent, CardHeader, CssBaseline, Divider, Grid, Hidden, IconButton, Input, SwipeableDrawer, Toolbar, Typography } from '@material-ui/core';\nimport { Close, Send } from '@material-ui/icons';\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport { me } from '../../state/actions/usersActions';\nimport Pusher from 'pusher-js';\nimport DrawerProfile from './DrawerProfile';\nimport theme from \"../../../themes/app_theme\";\nimport withStyles from '@material-ui/core/styles/withStyles';\nimport authStyle from '../styles/auth_style';\nimport ChatUsersList from './ChatUsersList';\nimport ChatProfile from './ChatProfile';\nimport { showUser } from '../../state/actions/usersActions';\nimport HorizontalLoading from '../loader/HorizontalLoading';\nimport { Link } from 'react-router-dom';\nimport { isInteger } from 'lodash';\n\nclass ChatBoard extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.initiatChat = () => {\n      let PUSHER_APP_KEY = \"52d240141d3de6310e4e\";\n      let pusher = new Pusher(PUSHER_APP_KEY, {\n        cluster: 'ap2',\n        forceTLS: true\n      });\n      let channel = pusher.subscribe(`channel-${this.sumId(this.props.user.attribute.id, this.props.chatUser.id)}`);\n      channel.bind(`broadcast-${this.sumId(this.props.user.id, this.props.chatUser.id)}`, data => {\n        this.showData(data);\n        console.log(`message:${data.id}`);\n      });\n    };\n\n    this.sumId = (id1, id2) => {\n      return Number(id1) + Number(id2);\n    };\n\n    this.showData = data => {\n      const {\n        chats\n      } = this.state;\n      chats.push(data);\n      this.setState(chats);\n    };\n\n    this.handleDrawerToggle = (value, page) => event => {\n      if (event && event.type === 'keydown' && (event.key === 'Tab' || event.key === 'Shift')) {\n        return;\n      }\n\n      this.setState({\n        mobileOpen: value,\n        currentPage: page\n      });\n    };\n\n    this.checkInfo = () => {};\n\n    this.showDialog = component => {\n      this.props.showMainDialog({\n        show: true,\n        style: {\n          display: 'flex',\n          flexDirection: 'row',\n          justifyContent: 'flex-start',\n          top: -550\n        },\n        maxWidth: 'sm',\n        page: component,\n        title: `Spark`,\n        actions: {\n          on: false,\n          path: '',\n          id: ''\n        }\n      });\n    };\n\n    this.state = {\n      chats: []\n    };\n  }\n\n  componentDidMount() {\n    this.props.me();\n    let id = this.props.match.params.id;\n    this.props.showUser(id);\n  }\n\n  render() {\n    const {\n      container\n    } = this.props;\n    const {\n      classes\n    } = this.props;\n    const drawer = /*#__PURE__*/React.createElement(\"div\", {\n      className: classes.drawerRoot,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(AppBar, {\n      style: {\n        position: \"relative\"\n      },\n      color: 'primary',\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(Toolbar, {\n      style: {\n        padding: 5\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(DrawerProfile, {\n      showBack: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 25\n      }\n    }))), /*#__PURE__*/React.createElement(ChatUsersList, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 102,\n        columnNumber: 17\n      }\n    }));\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: classes.root,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(CssBaseline, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 17\n      }\n    }), /*#__PURE__*/React.createElement(\"nav\", {\n      className: classes.drawer,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(Hidden, {\n      smUp: true,\n      implementation: \"css\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(SwipeableDrawer, {\n      container: container,\n      variant: \"temporary\",\n      anchor: theme.direction === 'rtl' ? 'right' : 'left',\n      open: this.state.mobileOpen,\n      onOpen: this.handleDrawerToggle(true, this.state.currentPage),\n      onClose: this.handleDrawerToggle(false, this.state.currentPage),\n      classes: {\n        paper: classes.drawerPaper\n      },\n      ModalProps: {\n        keepMounted: true // Better open performance on mobile.\n\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 25\n      }\n    }, drawer)), /*#__PURE__*/React.createElement(Hidden, {\n      xsDown: true,\n      implementation: \"css\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 129,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(SwipeableDrawer, {\n      classes: {\n        paper: classes.drawerPaper\n      },\n      variant: \"permanent\",\n      open: this.state.mobileOpen,\n      onOpen: this.handleDrawerToggle(true, this.state.currentPage),\n      onClose: this.handleDrawerToggle(false, this.state.currentPage),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 130,\n        columnNumber: 25\n      }\n    }, drawer))), /*#__PURE__*/React.createElement(\"main\", {\n      style: {\n        flexGrow: 1\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 143,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      style: {\n        height: '100vh'\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 144,\n        columnNumber: 21\n      }\n    }, this.props.chatLoading ? /*#__PURE__*/React.createElement(Grid, {\n      container: true,\n      spacing: 2,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 149,\n        columnNumber: 33\n      }\n    }, /*#__PURE__*/React.createElement(Grid, {\n      item: true,\n      md: 9,\n      xs: 12,\n      sm: 12,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 150,\n        columnNumber: 37\n      }\n    }, /*#__PURE__*/React.createElement(HorizontalLoading, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 151,\n        columnNumber: 44\n      }\n    })), /*#__PURE__*/React.createElement(Grid, {\n      item: true,\n      md: 3,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 154,\n        columnNumber: 37\n      }\n    }, /*#__PURE__*/React.createElement(HorizontalLoading, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 155,\n        columnNumber: 41\n      }\n    }))) : /*#__PURE__*/React.createElement(Grid, {\n      container: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 161,\n        columnNumber: 33\n      }\n    }, this.initiatChat(), /*#__PURE__*/React.createElement(Grid, {\n      item: true,\n      md: 8,\n      xs: 12,\n      sm: 12,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 163,\n        columnNumber: 37\n      }\n    }, /*#__PURE__*/React.createElement(Card, {\n      style: {\n        height: '100vh'\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 164,\n        columnNumber: 44\n      }\n    }, /*#__PURE__*/React.createElement(CardHeader, {\n      title: /*#__PURE__*/React.createElement(Typography, {\n        variant: 'h6',\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 167,\n          columnNumber: 53\n        }\n      }, `Your are matched with ${this.props.chatUser.attribute.name}`),\n      avatar: /*#__PURE__*/React.createElement(Avatar, {\n        src: this.props.chatUser.attribute.profile_pic_path,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 172,\n          columnNumber: 53\n        }\n      }),\n      action: /*#__PURE__*/React.createElement(IconButton, {\n        component: Link,\n        to: '/auth',\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 175,\n          columnNumber: 53\n        }\n      }, /*#__PURE__*/React.createElement(Close, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 176,\n          columnNumber: 57\n        }\n      })),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 165,\n        columnNumber: 48\n      }\n    }), /*#__PURE__*/React.createElement(Divider, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 180,\n        columnNumber: 48\n      }\n    }), /*#__PURE__*/React.createElement(CardContent, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 181,\n        columnNumber: 48\n      }\n    }, this.state.chats.map(chats => /*#__PURE__*/React.createElement(Typography, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 185,\n        columnNumber: 61\n      }\n    }, `Hi: ${chats.id}`))), /*#__PURE__*/React.createElement(CardActions, {\n      style: {\n        width: '100%',\n        top: '75%',\n        position: 'relative'\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 192,\n        columnNumber: 48\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      style: {\n        display: 'flex',\n        flexDirection: 'row',\n        width: '100%'\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 193,\n        columnNumber: 57\n      }\n    }, /*#__PURE__*/React.createElement(Input, {\n      placeholder: 'Write your message...',\n      style: {\n        width: '90%'\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 194,\n        columnNumber: 61\n      }\n    }), /*#__PURE__*/React.createElement(IconButton, {\n      color: 'primary',\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 198,\n        columnNumber: 61\n      }\n    }, /*#__PURE__*/React.createElement(Send, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 199,\n        columnNumber: 65\n      }\n    })))))), /*#__PURE__*/React.createElement(Grid, {\n      item: true,\n      md: 4,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 206,\n        columnNumber: 37\n      }\n    }, /*#__PURE__*/React.createElement(ChatProfile, {\n      user: this.props.chatUser,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 207,\n        columnNumber: 41\n      }\n    }))))));\n  }\n\n}\n\nconst mapStateToProps = state => ({\n  user: state.userData.user,\n  loading: state.userData.loading,\n  chatUser: state.userData.chatUser,\n  chatLoading: state.userData.chatLoading\n});\n\nexport default withStyles(authStyle)(connect(mapStateToProps, {\n  me,\n  showUser\n})(ChatBoard));","map":{"version":3,"sources":["D:/projects/spark/spark_front/src/authentication/users/widgets/ChatRoom.js"],"names":["AppBar","Avatar","Card","CardActions","CardContent","CardHeader","CssBaseline","Divider","Grid","Hidden","IconButton","Input","SwipeableDrawer","Toolbar","Typography","Close","Send","React","connect","me","Pusher","DrawerProfile","theme","withStyles","authStyle","ChatUsersList","ChatProfile","showUser","HorizontalLoading","Link","isInteger","ChatBoard","Component","constructor","props","initiatChat","PUSHER_APP_KEY","pusher","cluster","forceTLS","channel","subscribe","sumId","user","attribute","id","chatUser","bind","data","showData","console","log","id1","id2","Number","chats","state","push","setState","handleDrawerToggle","value","page","event","type","key","mobileOpen","currentPage","checkInfo","showDialog","component","showMainDialog","show","style","display","flexDirection","justifyContent","top","maxWidth","title","actions","on","path","componentDidMount","match","params","render","container","classes","drawer","drawerRoot","position","padding","root","direction","paper","drawerPaper","keepMounted","flexGrow","height","chatLoading","name","profile_pic_path","map","width","mapStateToProps","userData","loading"],"mappings":"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","sourcesContent":["import { AppBar, Avatar, Card, CardActions, CardContent, CardHeader, CssBaseline, Divider, Grid, Hidden, IconButton, Input, SwipeableDrawer, Toolbar, Typography } from '@material-ui/core'\r\nimport { Close, Send } from '@material-ui/icons'\r\nimport React from 'react'\r\nimport {connect} from 'react-redux'\r\nimport {me} from '../../state/actions/usersActions'\r\nimport Pusher from 'pusher-js'\r\nimport DrawerProfile from './DrawerProfile'\r\nimport theme from \"../../../themes/app_theme\";\r\nimport withStyles from '@material-ui/core/styles/withStyles'\r\nimport authStyle from '../styles/auth_style'\r\nimport ChatUsersList from './ChatUsersList'\r\nimport ChatProfile from './ChatProfile'\r\nimport {showUser} from '../../state/actions/usersActions'\r\nimport HorizontalLoading from '../loader/HorizontalLoading'\r\nimport { Link } from 'react-router-dom'\r\nimport { isInteger } from 'lodash'\r\nclass ChatBoard extends React.Component{\r\n\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            chats:[]\r\n        }\r\n    }\r\n    \r\n\r\n    componentDidMount(){\r\n        this.props.me()\r\n        let id = this.props.match.params.id\r\n        this.props.showUser(id)\r\n    }\r\n\r\n    initiatChat = ()=>{\r\n        let PUSHER_APP_KEY = \"52d240141d3de6310e4e\"\r\n    let pusher = new Pusher(PUSHER_APP_KEY, {\r\n      cluster: 'ap2',\r\n      forceTLS: true\r\n    });\r\n    \r\n    let channel = pusher.subscribe(`channel-${this.sumId(this.props.user.attribute.id,this.props.chatUser.id)}`);\r\n    channel.bind(`broadcast-${this.sumId(this.props.user.id,this.props.chatUser.id)}`,(data)=>{\r\n      this.showData(data)\r\n      console.log(`message:${data.id}`)\r\n\r\n    });\r\n    }\r\n\r\n    sumId = (id1,id2)=>{\r\n        return Number(id1)+Number(id2);\r\n    }\r\n\r\n    showData = (data)=>{\r\n        const {chats} = this.state\r\n        chats.push(data)\r\n        this.setState(chats)\r\n    }\r\n\r\n    /*componentDidUpdate(){\r\n        let id = this.props.match.params.id\r\n        this.props.showUser(id)\r\n    }*/\r\n\r\n    handleDrawerToggle = (value,page) => event=>{\r\n        if (event && event.type === 'keydown' && (event.key === 'Tab' || event.key === 'Shift')) {\r\n            return;\r\n        }\r\n        this.setState({\r\n            mobileOpen: value,\r\n            currentPage:page\r\n        })\r\n    }\r\n\r\n    checkInfo = ()=>{\r\n       \r\n    }\r\n\r\n    showDialog = (component)=>{\r\n        this.props.showMainDialog({\r\n            show:true,\r\n            style:{display:'flex',flexDirection:'row',justifyContent:'flex-start',top:-550},\r\n            maxWidth:'sm',\r\n            page:component,\r\n            title:`Spark`,\r\n            actions:{\r\n                on:false,\r\n                path:'',\r\n                id:''\r\n            }\r\n        })\r\n    }\r\n\r\n    render() {\r\n        const {container} = this.props;\r\n        const {classes} = this.props;\r\n        const drawer = (\r\n            <div className={classes.drawerRoot}>\r\n                <AppBar style={{position: \"relative\"}} color={'primary'}>\r\n                    <Toolbar style={{padding: 5}}>\r\n                        <DrawerProfile showBack={true}/>\r\n                    </Toolbar>\r\n                </AppBar>\r\n                <ChatUsersList/>\r\n            </div>\r\n        )\r\n        return (\r\n            <div className={classes.root}>\r\n                <CssBaseline/>\r\n                <nav className={classes.drawer}>\r\n                    {/* The implementation can be swapped with js to avoid SEO duplication of links. */}\r\n                    <Hidden smUp implementation=\"css\">\r\n                        <SwipeableDrawer\r\n                            container={container}\r\n                            variant=\"temporary\"\r\n                            anchor={theme.direction === 'rtl' ? 'right' : 'left'}\r\n                            open={this.state.mobileOpen}\r\n\r\n                            onOpen={this.handleDrawerToggle(true,this.state.currentPage)}\r\n                            onClose={this.handleDrawerToggle(false,this.state.currentPage)}\r\n                            classes={{\r\n                                paper: classes.drawerPaper,\r\n                            }}\r\n                            ModalProps={{\r\n                                keepMounted: true, // Better open performance on mobile.\r\n                            }}\r\n                        >\r\n                            {drawer}\r\n                        </SwipeableDrawer>\r\n                    </Hidden>\r\n                    <Hidden xsDown implementation=\"css\">\r\n                        <SwipeableDrawer\r\n                            classes={{\r\n                                paper: classes.drawerPaper,\r\n                            }}\r\n                            variant=\"permanent\"\r\n                            open={this.state.mobileOpen}\r\n                            onOpen={this.handleDrawerToggle(true,this.state.currentPage)}\r\n                            onClose={this.handleDrawerToggle(false,this.state.currentPage)}\r\n                        >\r\n                            {drawer}\r\n                        </SwipeableDrawer>\r\n                    </Hidden>\r\n                </nav>\r\n                <main style={{flexGrow:1}}>\r\n                    <div style={{height:'100vh'}}>\r\n                    {\r\n                        this.props.chatLoading\r\n                        ?\r\n                            (\r\n                                <Grid container spacing={2}>\r\n                                    <Grid item md={9} xs={12} sm={12}>\r\n                                           <HorizontalLoading/>\r\n                                    </Grid>\r\n\r\n                                    <Grid item md={3}>\r\n                                        <HorizontalLoading/>\r\n                                    </Grid>\r\n                                </Grid>\r\n                            )\r\n                        :\r\n                            (\r\n                                <Grid container>\r\n                                    {this.initiatChat()}\r\n                                    <Grid item md={8} xs={12} sm={12}>\r\n                                           <Card style={{height:'100vh'}}>\r\n                                               <CardHeader\r\n                                                title={\r\n                                                    <Typography variant={'h6'}>\r\n                                                        {`Your are matched with ${this.props.chatUser.attribute.name}`}\r\n                                                    </Typography>\r\n                                                }\r\n                                                avatar={\r\n                                                    <Avatar src={this.props.chatUser.attribute.profile_pic_path}/>\r\n                                                }\r\n                                                action={\r\n                                                    <IconButton component={Link} to={'/auth'}>\r\n                                                        <Close/>\r\n                                                    </IconButton>\r\n                                                }\r\n                                               />\r\n                                               <Divider/>\r\n                                               <CardContent>\r\n                                                {\r\n                                                    this.state.chats.map(\r\n                                                        chats=>(\r\n                                                            <Typography>\r\n                                                                {`Hi: ${chats.id}`}\r\n                                                            </Typography>\r\n                                                        )\r\n                                                    )\r\n                                                }\r\n                                               </CardContent>\r\n                                               <CardActions style={{width:'100%',top:'75%',position:'relative'}}>\r\n                                                        <div style={{display:'flex',flexDirection:'row',width:'100%'}}>\r\n                                                            <Input\r\n                                                             placeholder={'Write your message...'}\r\n                                                             style={{width:'90%'}}\r\n                                                            />\r\n                                                            <IconButton color={'primary'}>\r\n                                                                <Send/>\r\n                                                            </IconButton>\r\n                                                       </div>\r\n                                               </CardActions>\r\n                                           </Card>\r\n                                    </Grid>\r\n\r\n                                    <Grid item md={4}>\r\n                                        <ChatProfile user={this.props.chatUser}/>\r\n                                    </Grid>\r\n                                </Grid>\r\n                            )\r\n                    }\r\n                    </div>\r\n                </main>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\n\r\nconst mapStateToProps = state=>({\r\n    user:state.userData.user,\r\n    loading:state.userData.loading,\r\n    chatUser:state.userData.chatUser,\r\n    chatLoading:state.userData.chatLoading\r\n})\r\n\r\nexport default withStyles(authStyle)(connect(mapStateToProps,{me,showUser})(ChatBoard))"]},"metadata":{},"sourceType":"module"}